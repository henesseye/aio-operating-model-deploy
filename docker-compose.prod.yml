# Production Docker Compose - für interne Docker Registry
# Verwendung: docker-compose -f docker-compose.prod.yml up -d
#
# WICHTIG für Docker-Crew:
# 1. VERSION in .env setzen (z.B. VERSION=1.0.4)
# 2. DOCKER_REGISTRY in .env setzen (z.B. DOCKER_REGISTRY=your-registry.internal:5000/)
# 3. Images müssen VOR dem Deploy ins interne Repo transferiert werden
# 4. KEINE latest Tags verwenden - nur versionierte Images!

services:
  api:
    image: ${DOCKER_REGISTRY:-henesseye/}aio-operating-model-api:${VERSION:-latest}
    restart: always
    environment:
      JWT_SECRET: ${JWT_SECRET:-changeme-jwt-secret}
      ADMIN_PASSWORD: ${ADMIN_PASSWORD:-Admin123!}
      DATA_PATH: /data/model.json
      USERS_PATH: /data/users.json
      PORT: 3000
    volumes:
      - ./data:/data
    expose:
      - "3000"

  web:
    image: ${DOCKER_REGISTRY:-henesseye/}aio-operating-model-web:${VERSION:-latest}
    restart: always
    depends_on:
      - api
    ports:
      - "${PUBLIC_PORT:-80}:8080"